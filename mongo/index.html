<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <title>mongo的文档</title>
        <script type="text/javascript" src="/scripts/mass_merge.js"></script>
        <script type="text/javascript" src="/scripts/doc/shCore.js"></script>
        <script type="text/javascript" src="/scripts/doc/common.js"></script>
        <script type="text/javascript" src="/scripts/doc/shBrushJScript.js"></script>
        <script type="text/javascript" src="/scripts/doc/shBrushCss.js"></script>
        <script type="text/javascript" src="/scripts/doc/shBrushXml.js"></script>
        <link media="screen" rel="stylesheet" type="text/css" href="/styles/doc/common.css" />
        <link media="screen" rel="stylesheet" type="text/css" href="/styles/doc/shCore.css" />
        <link media="screen" rel="stylesheet" type="text/css" href="/styles/doc/shThemeRDark.css" />

        
        

    </head>
    <body>
        <article>
           

<h3>mongo的文档</h3>
<div><a href="http://try.mongodb.org/">shell</a> <a href="find">find</a> <a href="insert">insert</a></div>
<p>链接数据：</p>
<pre class="brush:javascript;gutter:false;toolbar:false">
var mongo  = require('mongodb');
//这里的northwind如果不存在就会新建一个，存在就用原来的，后面的格式固定
var db = new mongo.Db("northwind", new mongo.Server('localhost', 27017, {}), {});
db.open(function() {
    // 如果person这个集合不存在它会新建一个，存在就有原来的，
    // mongo的回调与node.js保持一致，出错第一个参数是Error对象
    db.collection("person", function(err, person) {
     //@@@@
    });
});
</pre>
<p>往集合里面插入数据，接着上面的例子，将@@@@改成如下代码</p>
<pre class="brush:javascript;gutter:false;toolbar:false">
       person.insert({
            "name":"111"
        })
        person.insert({
            "name":"222"
        })
        person.insert({
            "name":"333"
        })
</pre>
<p>好了，我们查看刚插入的数据，将@@@@改成如下代码</p>
<pre class="brush:javascript;gutter:false;toolbar:false">
        person.find( function(err, cursor) {
            cursor.each(function(err,a){
                console.log(a+"TEST")
            })
        })
</pre>
<p>竟然是输出：</p>
<pre class="brush:javascript;gutter:false;toolbar:false">
{ name: '111', _id: 5028a6e017a0be5c0c000001 }
{ name: '333', _id: 5028a6e017a0be5c0c000003 }
{ name: '222', _id: 5028a6e017a0be5c0c000002 }
null
</pre>
<p>collection对象通过find方法会返回一个cursor对象!它的构造器非常奇葩的，拥有近二十个传参，有空大家可以看看:</p>
<ul>
    <li><strong>db</strong> (<em>db</em>) &#8211; 返回它所在的数据库</li>
    <li><strong>collection</strong> (<em>collection</em>) &#8211; 返回它所在的集合</li>
    <li><strong>selector</strong> (<em>object</em>) &#8211; 返回查询条件，比如
        <pre class="brush:javascript;gutter:false;toolbar:false">
       person.find( {"aaa":"xxx"}, function(err, cursor) {
           cnsole.log(cursor.selector)//{"aaa":"xxx"}
        })
        </pre>
        <p>如果没有指定，返回一个空对象</p>
    </li>
    <li><strong>fields</strong> (<em>object</em>) &#8211; an object containing what fields to include or exclude from objects returned.</li>
    <li><strong>skip</strong> (<em>number</em>) &#8211; number of documents to skip.</li>
    <li><strong>limit</strong> (<em>number</em>) &#8211; the number of results to return. -1 has a special meaning and is used by Db.eval. A value of 1 will also be treated as if it were -1.</li>
    <li><strong>sort</strong> (<em>string</em>) &#8211; the required sorting for the query.</li>
    <li><strong>hint</strong> (<em>object</em>) &#8211; force the query to use a specific index.</li>
    <li><strong>explain</strong> (<em>boolean</em>) &#8211; return the explaination of the query.</li>
    <li><strong>snapshot</strong> (<em>boolean</em>) &#8211; Snapshot mode assures no duplicates are returned.</li>
    <li><strong>timeout</strong> (<em>boolean</em>) &#8211; allow the query to timeout.</li>
    <li><strong>tailable</strong> (<em>boolean</em>) &#8211; allow the cursor to be tailable.</li>
    <li><strong>awaitdata</strong> (<em>boolean</em>) &#8211; allow the cursor to wait for data, only applicable for tailable cursor.</li>
    <li><strong>batchSize</strong> (<em>number</em>) &#8211; the number of the subset of results to request the database to return for every request. This should initially be greater than 1 otherwise the database will automatically close the cursor. The batch size can be set to 1 with cursorInstance.batchSize after performing the initial query to the database.</li>
    <li><strong>raw</strong> (<em>boolean</em>) &#8211; return all query documents as raw buffers (default false).</li>
    <li><strong>read</strong> (<em>boolean</em>) &#8211; specify override of read from source (primary/secondary).</li>
    <li><strong>returnKey</strong> (<em>boolean</em>) &#8211; only return the index key.</li>
    <li><strong>maxScan</strong> (<em>number</em>) &#8211; limit the number of items to scan.</li>
    <li><strong>min</strong> (<em>number</em>) &#8211; set index bounds.</li>
    <li><strong>max</strong> (<em>number</em>) &#8211; set index bounds.</li>
    <li><strong>showDiskLoc</strong> (<em>boolean</em>) &#8211; show disk location of results.</li>
    <li><strong>comment</strong> (<em>string</em>) &#8211; you can put a $comment field on a query to make looking in the profiler logs simpler.</li>
    <li><strong>awaitdata</strong> &#8211; allow the cursor to wait for data, only applicable for tailable cursor.</li>
    <li><strong>numberOfRetries</strong> (<em>number</em>) &#8211; if using awaidata specifies the number of times to retry on timeout.</li>
    <li><strong>dbName</strong> (<em>string</em>) &#8211; override the default dbName.</li>
</ul>


http://www.cnblogs.com/huangxincheng/archive/2012/02/18/2356595.html
        </article>
   </body>
</html>