<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <title>collection.insert</title>
        <script type="text/javascript" src="/scripts/mass_merge.js"></script>
        <script type="text/javascript" src="/scripts/doc/shCore.js"></script>
        <script type="text/javascript" src="/scripts/doc/common.js"></script>
        <script type="text/javascript" src="/scripts/doc/shBrushJScript.js"></script>
        <script type="text/javascript" src="/scripts/doc/shBrushCss.js"></script>
        <script type="text/javascript" src="/scripts/doc/shBrushXml.js"></script>
        <link media="screen" rel="stylesheet" type="text/css" href="/styles/doc/common.css" />
        <link media="screen" rel="stylesheet" type="text/css" href="/styles/doc/shCore.css" />
        <link media="screen" rel="stylesheet" type="text/css" href="/styles/doc/shThemeRDark.css" />

        
        

    </head>
    <body>
        <article>
           

<h3>插入相关</h3>
<p>mongo的最小插入对象为文档，它外表看起来就是一个普通的javascript对象，而当我们用find方法取出来时就变成一个cursor对象</p>
<pre class="brush:javascript;gutter:false;toolbar:false">
var mongo  = require('mongodb');
var db = new mongo.Db("northwind", new mongo.Server('localhost', 27017, {}), {});
var doc = {
    author: 'joe',
    created : new Date('03/28/2009'),
    title : 'Yet another blog post',
    text : 'Here is the text...',
    tags : [ 'example', 'joe' ],
    comments : [ {
        author: 'jim',
        comment: 'I disagree'
    },
    {
        author: 'blue',
        comment: 'no,year'
    },
    {
        author: 'nancy',
        comment: 'Good post'
    }
    ]
}
db.open(function() {
    db.collection("posts", function(err, posts) {
        posts.insert(doc);
        posts.find( {
            "comments.author" : "jim"
        },function(e,cursor){
            cursor.nextObject(function(){
                console.log(cursor.items)
            })
        } )
    });
});
</pre>
<p>上面的open部分也可以写成</p>
<pre class="brush:javascript;gutter:false;toolbar:false">
db.open(function() {
    db.collection("posts", function(err, posts) {
        posts.insert(doc);
        var cursor = posts.find( {
            "comments.author" : "jim"
        })
        cursor.nextObject(function(){
            console.log(cursor.items)
        })

    });
});

</pre>
<p>插入一组文档</p>
<pre class="brush:javascript;gutter:false;toolbar:false">
  collection.insert([{hello:'world_safe1'}
      , {hello:'world_safe2'}], {safe:true}, function(err, result) {
      collection.findOne({hello:'world_safe2'}, function(err, item) {
        assert.equal(null, err);
        assert.equal('world_safe2', item.hello);
        db.close();
      })
</pre>
<br/>
        </article>
   </body>
</html>